apiVersion: template.openshift.io/v1
kind: Template
metadata:
  creationTimestamp: null
  name: loki-stack
objects:
- apiVersion: v1
  kind: Secret
  metadata:
    creationTimestamp: null
    name: ${LOKI_STORAGE_SECRET_NAME}
    namespace: rhobs-stage
  stringData:
    access_key_id: ${ACCESS_KEY_ID}
    access_key_secret: ${SECRET_ACCESS_KEY}
    bucketnames: ${S3_BUCKET_NAME}
    endpoint: https://${S3_BUCKET_ENDPOINT}
    region: ${S3_BUCKET_REGION}
  type: Opaque
- apiVersion: loki.grafana.com/v1
  kind: LokiStack
  metadata:
    creationTimestamp: null
    name: observatorium-lokistack
    namespace: rhobs-stage
  spec:
    managementState: Managed
    size: ${LOKI_SIZE}
    storage:
      schemas:
      - effectiveDate: "2025-06-06"
        version: v13
      secret:
        name: ${LOKI_STORAGE_SECRET_NAME}
        type: ${LOKI_STORAGE_SECRET_TYPE}
    storageClassName: ${LOKI_STORAGE_CLASS}
    tenants:
      mode: ${LOKI_TENANT_MODE}
  status:
    components: {}
    storage: {}
parameters:
- displayName: LokiStack Size
  name: LOKI_SIZE
  required: true
  value: 1x.medium
- displayName: Storage Class
  name: LOKI_STORAGE_CLASS
  required: true
  value: gp2
- displayName: Tenant Mode
  name: LOKI_TENANT_MODE
  required: true
  value: openshift-logging
- displayName: Storage Secret Name
  name: LOKI_STORAGE_SECRET_NAME
  required: true
  value: loki-storage
- displayName: Storage Secret Type
  name: LOKI_STORAGE_SECRET_TYPE
  required: true
  value: s3
- displayName: S3 Access Key ID
  name: ACCESS_KEY_ID
  required: true
- displayName: S3 Secret Access Key
  name: SECRET_ACCESS_KEY
  required: true
- displayName: S3 Bucket Name
  name: S3_BUCKET_NAME
  required: true
- displayName: S3 Bucket Endpoint
  name: S3_BUCKET_ENDPOINT
  required: true
- displayName: S3 Bucket Region
  name: S3_BUCKET_REGION
  required: true
  value: us-east-1
